<!DOCTYPE html>

<html>
  <head>
    <link rel="stylesheet" href="/review/style.css" />
  </head>

  <body>
    <!-- Firebase App (the core Firebase SDK) is always required and must be listed first -->
    <script src="https://www.gstatic.com/firebasejs/7.17.1/firebase-app.js"></script>

    <!-- If you enabled Analytics in your project, add the Firebase SDK for Analytics -->
    <script src="https://www.gstatic.com/firebasejs/7.17.1/firebase-analytics.js"></script>

    <!-- Add Firebase products that you want to use -->
    <script src="https://www.gstatic.com/firebasejs/7.17.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.17.1/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.17.1/firebase-database.js"></script>
    <script>
      let addressObject;
      let checkboxes = [];
      function httpGetAsync(theUrl, callback) {
        var xmlHttp = new XMLHttpRequest();
        xmlHttp.onreadystatechange = function() {
          if (xmlHttp.readyState == 4 && xmlHttp.status == 200)
            callback(xmlHttp.responseText);
        };
        xmlHttp.open("GET", theUrl, true); // true for asynchronous
        xmlHttp.send(null);
      }
      function initAutocomplete() {
        // Create the autocomplete object, restricting the search predictions to
        // geographical location types.
        autocomplete = new google.maps.places.Autocomplete(
          document.getElementById("address"),
          { types: ["geocode"] }
        );
        autocompleteEstablishment = new google.maps.places.Autocomplete(
          document.getElementById("name"),
          { types: ["establishment"] }
        );
        // Avoid paying for data that you don't need by restricting the set of
        // place fields that are returned to just the address components.
        autocomplete.setFields(["address_component"]);
        autocomplete.addListener("place_changed", geoCode);
      }
      function geoCode() {
        let place = autocomplete.getPlace();
        let address = `${place.address_components[0].long_name} ${place.address_components[1].long_name}, ${place.address_components[2].long_name}, ${place.address_components[4].long_name}`;
        let theUrl = `https://maps.googleapis.com/maps/api/geocode/json?address=${address}&key=AIzaSyBJfHI9Hjcc0MMDU280eGZ7CqR32m61n0k`;
        console.log(place);
        console.log(address);
        httpGetAsync(theUrl, getLatLong);
        
      }
      function getLatLong(object) {
        let addressObject = JSON.parse(object);
        console.log(
          `LAT: ${addressObject["results"][0]["geometry"]["location"].lat} Long: ${addressObject["results"][0]["geometry"]["location"].lng} `
        );
      }
      function readInput() {
        if (
          document.getElementById("name").value != null &&
          document.getElementById("address").value != null
        ) {
          console.log(document.getElementById("name").value);
          console.log(document.getElementById("address").value);
        }
        for (
          let i = 0;
          i < document.getElementsByTagName("input").length;
          i++
        ) {
          if (
            document.getElementsByTagName("input")[i].getAttribute("type") ==
            "checkbox"
          ) {
            checkboxes.push(i);
            console.log("yes");
          }
        }
      }
    </script>
    <div id="data">
      Bathroom Name: <input type="text" id="name" /><br />
      Bathroom Address: <input type="text" id="address" /><br />
      <input type="checkbox" />Sink/Running water <input type="checkbox" />Soap
      <input type="checkbox" />Hand Sanitizer <input type="checkbox" />Toilet
      paper<br />
      Cleanliness: <input type="range" min="0" max="5" /><br />
      Smell: <input type="range" min="0" max="5" /> <br />
      Ambiance: <input type="range" min="0" max="5" /><br />
      General comments/concerns: <input type="text" id="review" /><br />
      <button type="submit" id="submit" onclick="readInput()">
        Submit your review!
      </button>
    </div>
    <script
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBJfHI9Hjcc0MMDU280eGZ7CqR32m61n0k&libraries=places&callback=initAutocomplete"
      defer
    ></script>
  </body>
</html>
